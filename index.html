<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vkiedle - Zgadnij utwór Vkie</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
  <style>
    /* RESET */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* Czarny-szary, animowany gradient tła */
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #000, #333);
      background-size: 200% 200%;
      animation: bgAnimation 20s linear infinite;
      color: #f0f0f0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow-x: hidden;
    }
    
    @keyframes bgAnimation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    h1 {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 60px;
      margin: 20px 0;
      text-transform: uppercase;
      letter-spacing: 4px;
      color: #fff;
      text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8);
      text-align: center;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 20px;
      color: #ccc;
      text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.6);
      text-align: center;
    }
    
    .game-container {
      position: relative;
      width: 100%;
      max-width: 700px;
      background: rgba(0, 0, 0, 0.85);
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 0 30px rgba(0,0,0,0.8);
      overflow: hidden;
    }
    
    .input-container {
      position: relative;
      margin-bottom: 20px;
    }
    
    .input-area {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .input-area input[type="text"] {
      flex: 1;
      padding: 14px;
      font-size: 18px;
      border: none;
      border-radius: 4px;
      outline: none;
      background: #222;
      color: #f0f0f0;
      transition: background 0.3s, box-shadow 0.3s;
      min-width: 0;
    }
    
    .input-area input[type="text"]:focus {
      background: #2a2a2a;
      box-shadow: 0 0 8px #ffcc00;
    }
    
    .input-area button {
      padding: 14px 22px;
      font-size: 18px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: #ffcc00;
      color: #222;
      transition: background 0.3s, transform 0.2s;
      flex-shrink: 0;
    }
    
    .input-area button:hover {
      background: #e6b800;
      transform: scale(1.03);
    }
    
    .suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: #222;
      border: 1px solid #444;
      border-top: none;
      max-height: 150px;
      overflow-y: auto;
      z-index: 10;
      display: none;
      border-radius: 0 0 4px 4px;
    }
    
    .suggestion-item {
      padding: 10px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .suggestion-item:hover {
      background: #444;
    }
    
    .board {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 20px;
    }
    
    .board .header {
      font-weight: bold;
      text-align: center;
      padding: 8px;
      border-bottom: 2px solid #555;
    }
    
    .guess-row {
      display: contents;
    }
    
    .cell {
      text-align: center;
      padding: 10px;
      border-radius: 4px;
      background-color: #555;
      min-height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      transition: background 0.3s;
    }
    
    .correct {
      background-color: #3c6;
      color: #fff;
    }
    
    .close {
      background-color: #f1c40f;
      color: #222;
    }
    
    .wrong {
      background-color: #555;
      color: #ccc;
    }
    
    .result-area {
      text-align: center;
      margin-bottom: 20px;
      font-size: 20px;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.6);
    }
    
    .cover-image {
      display: block;
      margin: 10px auto;
      max-width: 250px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0,0,0,0.7);
    }
    
    .restart-btn {
      display: block;
      margin: 20px auto;
      padding: 14px 28px;
      font-size: 18px;
      border: none;
      border-radius: 4px;
      background: #ffcc00;
      color: #222;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    
    .restart-btn:hover {
      background: #e6b800;
      transform: scale(1.03);
    }
    
    footer {
      margin-top: 40px;
      font-size: 14px;
      color: #777;
      text-align: center;
    }
    
    /* Particle container */
    #particle-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 100;
    }
    
    .particle {
      position: absolute;
      width: 8px;
      height: 8px;
      background-color: var(--color);
      border-radius: 50%;
      opacity: 1;
      animation: particleAnimation 1s ease-out forwards;
    }
    
    @keyframes particleAnimation {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(0.5);
        opacity: 0;
      }
    }
    
    /* Responsywność na urządzenia mobilne */
    @media (max-width: 768px) {
      h1 {
        font-size: 40px;
      }
      .subtitle {
        font-size: 16px;
      }
      .game-container {
        padding: 20px;
      }
      .input-area input[type="text"],
      .input-area button {
        font-size: 16px;
        padding: 12px;
      }
      .board .header {
        font-size: 14px;
        padding: 6px;
      }
      .cell {
        font-size: 14px;
        padding: 8px;
      }
      .restart-btn {
        font-size: 16px;
        padding: 12px 20px;
      }
    }
  </style>
</head>
<body>
  <h1>Vkiedle</h1>
  <div class="subtitle">Zgadnij tajemniczy utwór Vkie – masz 8 prób!</div>
  <div class="game-container">
    <!-- Container na particle efekty -->
    <div id="particle-container"></div>
    <div class="input-container">
      <div class="input-area">
        <input type="text" id="guessInput" placeholder="Wpisz tytuł piosenki...">
        <button id="guessBtn">Zgaduj</button>
      </div>
      <div class="suggestions" id="suggestions"></div>
    </div>
    <div class="board" id="board">
      <div class="header">Tytuł</div>
      <div class="header">Album</div>
      <div class="header">Track No.</div>
      <div class="header">Długość</div>
      <div class="header">Goście</div>
    </div>
    <div class="result-area" id="resultMessage"></div>
    <img id="coverImage" class="cover-image" src="" alt="" style="display:none;">
    <button class="restart-btn" id="restartBtn" style="display:none;">Zagraj ponownie</button>
  </div>
  <footer>
    Stworzone inspirowane <a href="https://yeezle.xyz" target="_blank" style="color: #ffcc00;">yeezle.xyz</a>
  </footer>
  
  <script>
    // Lista piosenek Vkie z albumu "Dżungla"
    const songsData = [
      { title: "My Kontra Oni", album: "Dżungla", trackNumber: 1, length: 210, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Mięta", album: "Dżungla", trackNumber: 2, length: 200, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Smi", album: "Dżungla", trackNumber: 3, length: 190, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "To I Tamto (feat. Schafter)", album: "Dżungla", trackNumber: 4, length: 220, features: ["Schafter"], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Hannah Montana", album: "Dżungla", trackNumber: 5, length: 205, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Crazy Frog", album: "Dżungla", trackNumber: 6, length: 230, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Toksyny", album: "Dżungla", trackNumber: 7, length: 215, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Bozo", album: "Dżungla", trackNumber: 8, length: 205, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Jestem W Stanie (feat. Pazzy)", album: "Dżungla", trackNumber: 9, length: 225, features: ["Pazzy"], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Wwv (feat. White Widow)", album: "Dżungla", trackNumber: 10, length: 240, features: ["White Widow"], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Daj Pare Mi", album: "Dżungla", trackNumber: 11, length: 210, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Nauczyłem Się", album: "Dżungla", trackNumber: 12, length: 200, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Twoja Liga Niska (feat. Astrogxral)", album: "Dżungla", trackNumber: 13, length: 230, features: ["Astrogxral"], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Aleppo", album: "Dżungla", trackNumber: 14, length: 220, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Algorytm (feat. MłodyBa)", album: "Dżungla", trackNumber: 15, length: 235, features: ["MłodyBa"], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Jebać Twoich Ziomów", album: "Dżungla", trackNumber: 16, length: 250, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Big Jungle Shit (Outro)", album: "Dżungla", trackNumber: 17, length: 180, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Kochanie Zrozum Mnie [Bonus Track]", album: "Dżungla", trackNumber: 18, length: 240, features: [], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" },
      { title: "Pustka [Bonus Track] (feat. Olszakumpel)", album: "Dżungla", trackNumber: 19, length: 230, features: ["Olszakumpel"], cover: "https://via.placeholder.com/300x300.png?text=Dżungla" }
    ];
    
    let eliminatedTitles = [];
    const MAX_GUESSES = 8;
    let secretSong = null;
    let attempts = 0;
    let gameOver = false;
    
    const guessInput = document.getElementById("guessInput");
    const guessBtn = document.getElementById("guessBtn");
    const board = document.getElementById("board");
    const resultMessage = document.getElementById("resultMessage");
    const coverImage = document.getElementById("coverImage");
    const restartBtn = document.getElementById("restartBtn");
    const suggestionsContainer = document.getElementById("suggestions");
    const particleContainer = document.getElementById("particle-container");
    
    // Funkcja pokazująca sugestie podczas wpisywania
    function handleSuggestions() {
      const query = guessInput.value.trim().toLowerCase();
      suggestionsContainer.innerHTML = "";
      if (!query) {
        suggestionsContainer.style.display = "none";
        return;
      }
      const matchedSongs = songsData.filter(song =>
        song.title.toLowerCase().startsWith(query) &&
        !eliminatedTitles.includes(song.title.toLowerCase())
      );
      if (matchedSongs.length === 0) {
        suggestionsContainer.style.display = "none";
        return;
      }
      matchedSongs.forEach(song => {
        const item = document.createElement("div");
        item.classList.add("suggestion-item");
        item.textContent = song.title;
        item.addEventListener("click", () => {
          guessInput.value = song.title;
          suggestionsContainer.innerHTML = "";
          suggestionsContainer.style.display = "none";
        });
        suggestionsContainer.appendChild(item);
      });
      suggestionsContainer.style.display = "block";
    }
    
    guessInput.addEventListener("input", handleSuggestions);
    
    // Pomocnicza funkcja do dodawania strzałki
    function getArrow(guess, secret) {
      if (guess < secret) return " ↑";
      if (guess > secret) return " ↓";
      return "";
    }
    
    // Porównanie albumu
    function compareAlbum(guessAlbum, secretAlbum) {
      if (guessAlbum === secretAlbum) {
        return { status: "correct", label: guessAlbum };
      }
      return { status: "wrong", label: guessAlbum };
    }
    
    // Porównanie numeru utworu
    function compareTrackNumber(guessNum, secretNum) {
      if (guessNum === secretNum) {
        return { status: "correct", label: guessNum };
      }
      if (Math.abs(guessNum - secretNum) <= 2) {
        return { 
          status: "close", 
          label: guessNum + getArrow(guessNum, secretNum)
        };
      }
      return { status: "wrong", label: guessNum };
    }
    
    // Porównanie długości utworu (w sekundach)
    function compareLength(guessLen, secretLen) {
      if (guessLen === secretLen) {
        return { status: "correct", label: formatLength(guessLen) };
      }
      if (Math.abs(guessLen - secretLen) <= 30) {
        return { 
          status: "close", 
          label: formatLength(guessLen) + getArrow(guessLen, secretLen)
        };
      }
      return { status: "wrong", label: formatLength(guessLen) };
    }
    
    // Porównanie featured – jeżeli choć jeden element pasuje, to "close"
    function compareFeatures(guessFeatures, secretFeatures) {
      const guessLower = guessFeatures.map(f => f.toLowerCase());
      const secretLower = secretFeatures.map(f => f.toLowerCase());
      if (guessLower.length === secretLower.length &&
          guessLower.every(f => secretLower.includes(f))) {
        return { status: "correct", label: guessFeatures.join(", ") || "Brak" };
      }
      const intersection = guessLower.filter(f => secretLower.includes(f));
      if (intersection.length > 0) {
        return { status: "close", label: guessFeatures.join(", ") || "Brak" };
      }
      return { status: "wrong", label: guessFeatures.join(", ") || "Brak" };
    }
    
    // Formatowanie długości (mm:ss)
    function formatLength(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${m}:${s.toString().padStart(2, "0")}`;
    }
    
    // Dodawanie wiersza do planszy
    function addGuessRow(guessData) {
      const rowCells = [];
      const columns = ["title", "album", "trackNumber", "length", "features"];
      columns.forEach(col => {
        const cell = document.createElement("div");
        cell.classList.add("cell", guessData[col].status);
        cell.textContent = guessData[col].label;
        rowCells.push(cell);
      });
      const rowContainer = document.createElement("div");
      rowContainer.classList.add("guess-row");
      rowCells.forEach(cell => rowContainer.appendChild(cell));
      board.appendChild(rowContainer);
    }
    
    // Funkcja generująca particle efekty (confetti) przy wygranej – zwiększona liczba cząsteczek
    function spawnParticles() {
      const colors = ["#ffcc00", "#ff6699", "#66ccff", "#99ff66", "#ff9900"];
      const numParticles = 150;
      const containerRect = particleContainer.getBoundingClientRect();
      const originX = containerRect.width / 2;
      const originY = containerRect.height / 2;
      
      for (let i = 0; i < numParticles; i++) {
        const particle = document.createElement("div");
        particle.classList.add("particle");
        const color = colors[Math.floor(Math.random() * colors.length)];
        particle.style.setProperty("--color", color);
        particle.style.left = originX + "px";
        particle.style.top = originY + "px";
        const tx = (Math.random() - 0.5) * 300;
        const ty = (Math.random() - 0.5) * 300;
        particle.style.setProperty("--tx", tx + "px");
        particle.style.setProperty("--ty", ty + "px");
        particleContainer.appendChild(particle);
        particle.addEventListener("animationend", () => {
          particle.remove();
        });
      }
    }
    
    // Obsługa zgadywania
    function handleGuess() {
      if (gameOver) return;
      const guessTitle = guessInput.value.trim();
      if (!guessTitle) return;
      const guessedSong = songsData.find(song => song.title.toLowerCase() === guessTitle.toLowerCase());
      attempts++;
    
      if (!guessedSong) {
        addGuessRow({
          title: { status: "wrong", label: guessTitle },
          album: { status: "wrong", label: "Nieznany tytuł" },
          trackNumber: { status: "wrong", label: "?" },
          length: { status: "wrong", label: "?" },
          features: { status: "wrong", label: "?" }
        });
        resultMessage.textContent = `Piosenka "${guessTitle}" nie została znaleziona.`;
        guessInput.value = "";
        if (attempts >= MAX_GUESSES) endGame(false);
        suggestionsContainer.style.display = "none";
        return;
      }
    
      if (guessedSong.title.toLowerCase() !== secretSong.title.toLowerCase()) {
        if (!eliminatedTitles.includes(guessedSong.title.toLowerCase())) {
          eliminatedTitles.push(guessedSong.title.toLowerCase());
        }
      }
    
      const titleData = {
        status: (guessedSong.title.toLowerCase() === secretSong.title.toLowerCase()) ? "correct" : "wrong",
        label: guessedSong.title
      };
      const albumData = compareAlbum(guessedSong.album, secretSong.album);
      const trackData = compareTrackNumber(guessedSong.trackNumber, secretSong.trackNumber);
      const lengthData = compareLength(guessedSong.length, secretSong.length);
      const featuresData = compareFeatures(guessedSong.features, secretSong.features);
    
      addGuessRow({
        title: titleData,
        album: albumData,
        trackNumber: trackData,
        length: lengthData,
        features: featuresData
      });
    
      if (guessedSong.title.toLowerCase() === secretSong.title.toLowerCase()) {
        endGame(true);
        return;
      }
      if (attempts >= MAX_GUESSES) {
        endGame(false);
      }
      guessInput.value = "";
      suggestionsContainer.innerHTML = "";
      suggestionsContainer.style.display = "none";
    }
    
    function endGame(win) {
      gameOver = true;
      guessInput.disabled = true;
      guessBtn.disabled = true;
      restartBtn.style.display = "block";
      if (win) {
        resultMessage.textContent = `Gratulacje! To faktycznie "${secretSong.title}"!`;
        spawnParticles();
      } else {
        resultMessage.textContent = `Koniec prób! Poprawna odpowiedź: "${secretSong.title}".`;
      }
      coverImage.src = secretSong.cover;
      coverImage.alt = secretSong.title;
      coverImage.style.display = "block";
    }
    
    function startGame() {
      document.querySelectorAll(".guess-row").forEach(row => row.remove());
      attempts = 0;
      gameOver = false;
      guessInput.value = "";
      guessInput.disabled = false;
      guessBtn.disabled = false;
      resultMessage.textContent = "";
      coverImage.style.display = "none";
      coverImage.src = "";
      restartBtn.style.display = "none";
      eliminatedTitles = [];
      suggestionsContainer.innerHTML = "";
      suggestionsContainer.style.display = "none";
      particleContainer.innerHTML = "";
      secretSong = songsData[Math.floor(Math.random() * songsData.length)];
      console.log("Tajna piosenka:", secretSong.title);
    }
    
    guessBtn.addEventListener("click", handleGuess);
    guessInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        handleGuess();
      }
    });
    restartBtn.addEventListener("click", startGame);
    
    startGame();
  </script>
</body>
</html>